<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ËÄÅÈªÑÂéÜ - Êã©ÂêâÈÅøÂá∂</title>
  <script src="https://cdn.jsdelivr.net/npm/lunar-javascript/lunar.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; -webkit-tap-highlight-color: transparent; }
    
    :root {
      --primary: #a31e2e;
      --primary-light: #c93a4d;
      --gold: #c9a227;
      --gold-light: #e8c547;
      --bg: #f5f2ed;
      --card: #fffbf5;
      --text: #2d2d2d;
      --text-light: #666;
      --border: #e0d8cc;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.5;
    }
    
    .container {
      max-width: 480px;
      margin: 0 auto;
      padding: 0;
      background: var(--bg);
      min-height: 100vh;
    }
    
    /* ‰ªäÊó•ÈªÑÂéÜÂç°Áâá */
    .today-card {
      background: linear-gradient(135deg, var(--card) 0%, #fff 100%);
      margin: 12px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(163, 30, 46, 0.1);
      overflow: hidden;
    }
    
    .today-header {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
      color: white;
      padding: 20px;
      text-align: center;
    }
    
    .today-date {
      font-size: 1.8rem;
      font-weight: 700;
      margin-bottom: 4px;
    }
    
    .today-week {
      font-size: 0.9rem;
      opacity: 0.9;
    }
    
    .today-lunar {
      background: linear-gradient(135deg, var(--gold) 0%, var(--gold-light) 100%);
      color: #5c4006;
      padding: 12px 20px;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 15px;
      font-size: 0.95rem;
    }
    
    .today-lunar span {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .today-info {
      padding: 16px 20px;
    }
    
    .info-row {
      display: flex;
      gap: 12px;
      margin-bottom: 12px;
    }
    
    .info-box {
      flex: 1;
      background: #faf7f2;
      border-radius: 10px;
      padding: 12px;
    }
    
    .info-box:last-child { margin-bottom: 0; }
    
    .info-label {
      font-size: 0.75rem;
      color: var(--text-light);
      margin-bottom: 4px;
      display: flex;
      align-items: center;
      gap: 4px;
    }
    
    .info-label::before {
      content: '';
      display: inline-block;
      width: 6px;
      height: 6px;
      border-radius: 50%;
    }
    
    .info-box.yi .info-label::before { background: #2e7d32; }
    .info-box.ji .info-label::before { background: #c62828; }
    
    .info-value {
      font-size: 0.85rem;
      line-height: 1.6;
    }
    
    .yi .info-value { color: #2e7d32; }
    .ji .info-value { color: #c62828; }
    
    /* Êó•ÂéÜ */
    .calendar-card {
      background: var(--card);
      margin: 12px;
      border-radius: 16px;
      box-shadow: 0 4px 20px rgba(163, 30, 46, 0.08);
      overflow: hidden;
    }
    
    .calendar-header {
      background: var(--primary);
      color: white;
      padding: 16px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .calendar-title {
      font-size: 1.1rem;
      font-weight: 600;
    }
    
    .calendar-nav {
      display: flex;
      gap: 8px;
    }
    
    .calendar-nav button {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      width: 32px;
      height: 32px;
      border-radius: 8px;
      font-size: 1rem;
      cursor: pointer;
      transition: background 0.2s;
    }
    
    .calendar-nav button:active {
      background: rgba(255,255,255,0.3);
    }
    
    .weekdays {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      background: #faf7f2;
      padding: 10px 0;
      border-bottom: 1px solid var(--border);
    }
    
    .weekdays div {
      text-align: center;
      font-size: 0.8rem;
      color: var(--text-light);
      font-weight: 500;
    }
    
    .days {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
    }
    
    .day {
      aspect-ratio: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      border: 1px solid var(--border);
      border-top: none;
      border-left: none;
      cursor: pointer;
      transition: all 0.15s;
      position: relative;
      background: white;
    }
    
    .day:nth-child(7n) { border-right: none; }
    
    .day:active {
      background: #fff3e0;
    }
    
    .day.other-month {
      color: #ccc;
      background: #fafafa;
    }
    
    .day.today {
      background: linear-gradient(135deg, #fff3e0 0%, #ffe0b2 100%);
    }
    
    .day.today .day-num {
      color: var(--primary);
      font-weight: 700;
    }
    
    .day.has-event::after {
      content: '';
      position: absolute;
      bottom: 4px;
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: var(--primary);
    }
    
    .day-num {
      font-size: 0.95rem;
      color: var(--text);
    }
    
    .day-lunar {
      font-size: 0.55rem;
      color: var(--text-light);
      margin-top: 2px;
      max-width: 90%;
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }
    
    /* ‰∫ã‰ª∂ÂºπÁ™ó */
    .modal {
      display: none;
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.5);
      z-index: 1000;
      align-items: flex-end;
      justify-content: center;
    }
    
    .modal.show { display: flex; }
    
    .modal-content {
      background: white;
      width: 100%;
      max-width: 480px;
      border-radius: 20px 20px 0 0;
      padding: 24px;
      max-height: 70vh;
      overflow-y: auto;
      animation: slideUp 0.3s ease;
    }
    
    @keyframes slideUp {
      from { transform: translateY(100%); }
      to { transform: translateY(0); }
    }
    
    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    
    .modal-title {
      font-size: 1.2rem;
      font-weight: 600;
      color: var(--primary);
    }
    
    .modal-close {
      background: none;
      border: none;
      font-size: 1.5rem;
      color: var(--text-light);
      cursor: pointer;
      padding: 5px;
    }
    
    .modal-huangli {
      background: #faf7f2;
      border-radius: 12px;
      padding: 15px;
      margin-bottom: 20px;
    }
    
    .modal-huangli-title {
      font-size: 0.85rem;
      color: var(--text-light);
      margin-bottom: 8px;
    }
    
    .modal-yiji {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .tag {
      padding: 4px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
    }
    
    .tag.yi { background: #e8f5e9; color: #2e7d32; }
    .tag.ji { background: #ffebee; color: #c62828; }
    
    .event-list {
      margin-bottom: 16px;
    }
    
    .event-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px;
      background: #faf7f2;
      border-radius: 10px;
      margin-bottom: 8px;
    }
    
    .event-text {
      flex: 1;
    }
    
    .event-delete {
      background: #ffebee;
      border: none;
      color: #c62828;
      padding: 6px 12px;
      border-radius: 6px;
      font-size: 0.8rem;
      cursor: pointer;
    }
    
    .event-input-row {
      display: flex;
      gap: 10px;
    }
    
    .event-input-row input {
      flex: 1;
      padding: 12px 16px;
      border: 2px solid var(--border);
      border-radius: 10px;
      font-size: 1rem;
      outline: none;
      transition: border-color 0.2s;
    }
    
    .event-input-row input:focus {
      border-color: var(--primary);
    }
    
    .event-input-row button {
      background: var(--primary);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 1rem;
      cursor: pointer;
    }
    
    .empty-events {
      text-align: center;
      color: var(--text-light);
      padding: 30px;
      font-size: 0.9rem;
    }
    
    /* Ê°åÈù¢Á´Ø‰ºòÂåñ */
    @media (min-width: 600px) {
      .container {
        padding: 20px;
        max-width: 900px;
      }
      
      .today-card, .calendar-card {
        margin: 0 0 20px 0;
      }
      
      .today-header { padding: 24px; }
      .today-date { font-size: 2.2rem; }
      
      .day { min-height: 70px; }
      .day-num { font-size: 1.1rem; }
      .day-lunar { font-size: 0.7rem; }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- ‰ªäÊó•ÈªÑÂéÜ -->
    <div class="today-card" id="todayCard"></div>
    
    <!-- Êó•ÂéÜ -->
    <div class="calendar-card">
      <div class="calendar-header">
        <span class="calendar-title" id="calendarTitle">2026Âπ¥1Êúà</span>
        <div class="calendar-nav">
          <button id="prevMonth">‚Äπ</button>
          <button id="nextMonth">‚Ä∫</button>
        </div>
      </div>
      <div class="weekdays">
        <div>Êó•</div><div>‰∏Ä</div><div>‰∫å</div><div>‰∏â</div><div>Âõõ</div><div>‰∫î</div><div>ÂÖ≠</div>
      </div>
      <div class="days" id="daysGrid"></div>
    </div>
  </div>
  
  <!-- ‰∫ã‰ª∂ÂºπÁ™ó -->
  <div class="modal" id="eventModal">
    <div class="modal-content">
      <div class="modal-header">
        <span class="modal-title" id="modalTitle">2026Âπ¥1Êúà31Êó•</span>
        <button class="modal-close" onclick="closeModal()">√ó</button>
      </div>
      <div class="modal-huangli" id="modalHuangli"></div>
      <div class="event-list" id="eventList"></div>
      <div class="event-input-row">
        <input type="text" id="eventInput" placeholder="Ê∑ªÂä†‰∫ã‰ª∂..." maxlength="50">
        <button onclick="addEvent()">Ê∑ªÂä†</button>
      </div>
    </div>
  </div>
  
  <script>
    // Solar Âíå Lunar Â∑≤ÈÄöËøá CDN ÊåÇËΩΩÂà∞ÂÖ®Â±Ä
    
    let currentDate = new Date();
    let selectedDate = null;
    const events = JSON.parse(localStorage.getItem('huangli-events') || '{}');
    
    // ÂàùÂßãÂåñ
    document.addEventListener('DOMContentLoaded', () => {
      renderToday();
      renderCalendar();
      document.getElementById('prevMonth').onclick = () => changeMonth(-1);
      document.getElementById('nextMonth').onclick = () => changeMonth(1);
      document.getElementById('eventInput').onkeypress = e => e.key === 'Enter' && addEvent();
      document.getElementById('eventModal').onclick = e => e.target.id === 'eventModal' && closeModal();
    });
    
    // Ê∏≤Êüì‰ªäÊó•ÈªÑÂéÜ
    function renderToday() {
      const today = new Date();
      const solar = Solar.fromYmd(today.getFullYear(), today.getMonth() + 1, today.getDate());
      const lunar = solar.getLunar();
      
      const weekDays = ['Âë®Êó•', 'Âë®‰∏Ä', 'Âë®‰∫å', 'Âë®‰∏â', 'Âë®Âõõ', 'Âë®‰∫î', 'Âë®ÂÖ≠'];
      const yi = lunar.getDayYi();
      const ji = lunar.getDayJi();
      
      document.getElementById('todayCard').innerHTML = `
        <div class="today-header">
          <div class="today-date">${today.getMonth() + 1}Êúà${today.getDate()}Êó•</div>
          <div class="today-week">${weekDays[today.getDay()]} | ${lunar.getYearInChinese()}Âπ¥</div>
        </div>
        <div class="today-lunar">
          <span>üßß ${lunar.getMonthInChinese()}Êúà${lunar.getDayInChinese()}</span>
          <span>üìÖ ${lunar.getSolar().getConstellation()}</span>
        </div>
        <div class="today-info">
          <div class="info-row">
            <div class="info-box yi">
              <div class="info-label">ÂÆú</div>
              <div class="info-value">${yi.slice(0, 4).join(' ')}${yi.length > 4 ? '...' : ''}</div>
            </div>
            <div class="info-box ji">
              <div class="info-label">Âøå</div>
              <div class="info-value">${ji.slice(0, 4).join(' ')}${ji.length > 4 ? '...' : ''}</div>
            </div>
          </div>
          <div class="info-box">
            <div class="info-label">ÂÜ≤ÁÖû ¬∑ ÂêâÁ•û</div>
            <div class="info-value">${lunar.getChao()} | ${lunar.getDayJiShen().slice(0, 2).join(' ') || 'Êó†'}</div>
          </div>
        </div>
      `;
    }
    
    // Ê∏≤ÊüìÊó•ÂéÜ
    function renderCalendar() {
      const year = currentDate.getFullYear();
      const month = currentDate.getMonth();
      
      document.getElementById('calendarTitle').textContent = `${year}Âπ¥${month + 1}Êúà`;
      
      const firstDay = new Date(year, month, 1);
      const lastDay = new Date(year, month + 1, 0);
      const startDate = new Date(firstDay);
      startDate.setDate(startDate.getDate() - firstDay.getDay());
      
      const today = new Date();
      let html = '';
      
      for (let i = 0; i < 42; i++) {
        const date = new Date(startDate);
        date.setDate(date.getDate() + i);
        
        const isOtherMonth = date.getMonth() !== month;
        const isToday = date.getFullYear() === today.getFullYear() && 
                       date.getMonth() === today.getMonth() && 
                       date.getDate() === today.getDate();
        
        const solar = Solar.fromYmd(date.getFullYear(), date.getMonth() + 1, date.getDate());
        const lunar = solar.getLunar();
        
        const dateKey = `${date.getFullYear()}-${String(date.getMonth() + 1).padStart(2, '0')}-${String(date.getDate()).padStart(2, '0')}`;
        const hasEvent = events[dateKey]?.length > 0;
        
        html += `
          <div class="day ${isOtherMonth ? 'other-month' : ''} ${isToday ? 'today' : ''} ${hasEvent ? 'has-event' : ''}" 
               onclick="openModal('${dateKey}', '${date.getFullYear()}Âπ¥${date.getMonth() + 1}Êúà${date.getDate()}Êó•')">
            <div class="day-num">${date.getDate()}</div>
            <div class="day-lunar">${lunar.getDayInChinese()}</div>
          </div>
        `;
      }
      
      document.getElementById('daysGrid').innerHTML = html;
    }
    
    function changeMonth(delta) {
      currentDate.setMonth(currentDate.getMonth() + delta);
      renderCalendar();
    }
    
    function openModal(dateKey, dateStr) {
      selectedDate = dateKey;
      const date = new Date(dateKey.replace(/-/g, '/'));
      const solar = Solar.fromYmd(date.getFullYear(), date.getMonth() + 1, date.getDate());
      const lunar = solar.getLunar();
      
      document.getElementById('modalTitle').textContent = dateStr;
      
      const yi = lunar.getDayYi();
      const ji = lunar.getDayJi();
      
      document.getElementById('modalHuangli').innerHTML = `
        <div class="modal-huangli-title">ÂΩìÊó•ÂÆúÂøå</div>
        <div class="modal-yiji">
          ${yi.slice(0, 6).map(t => `<span class="tag yi">ÂÆú${t}</span>`).join('')}
          ${ji.slice(0, 6).map(t => `<span class="tag ji">Âøå${t}</span>`).join('')}
        </div>
      `;
      
      renderEvents();
      document.getElementById('eventModal').classList.add('show');
      document.getElementById('eventInput').focus();
    }
    
    function closeModal() {
      document.getElementById('eventModal').classList.remove('show');
    }
    
    function renderEvents() {
      const list = document.getElementById('eventList');
      const dateEvents = events[selectedDate] || [];
      
      if (dateEvents.length === 0) {
        list.innerHTML = '<div class="empty-events">ÊöÇÊó†‰∫ã‰ª∂ÔºåÁÇπÂáªÊ∑ªÂä†</div>';
        return;
      }
      
      list.innerHTML = dateEvents.map((e, i) => `
        <div class="event-item">
          <span class="event-text">${e}</span>
          <button class="event-delete" onclick="deleteEvent(${i})">Âà†Èô§</button>
        </div>
      `).join('');
    }
    
    function addEvent() {
      const input = document.getElementById('eventInput');
      const text = input.value.trim();
      if (!text) return;
      
      if (!events[selectedDate]) events[selectedDate] = [];
      events[selectedDate].push(text);
      localStorage.setItem('huangli-events', JSON.stringify(events));
      
      input.value = '';
      renderEvents();
      renderCalendar();
    }
    
    function deleteEvent(index) {
      events[selectedDate].splice(index, 1);
      if (events[selectedDate].length === 0) delete events[selectedDate];
      localStorage.setItem('huangli-events', JSON.stringify(events));
      renderEvents();
      renderCalendar();
    }
  </script>
</body>
</html>
